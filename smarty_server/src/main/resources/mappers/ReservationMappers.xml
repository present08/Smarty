<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.green.smarty.mapper.ReservationMapper">
    <insert id="insertFacility" parameterType="com.green.smarty.vo.FacilityVO">
        insert into facility(facility_id, facility_name, open_time, close_time, default_time,basic_fee,rate_adjustment,hot_time,contact, info, caution, court,product, facility_status, facility_images) values(#{facility_id}, #{facility_name}, #{open_time}, #{close_time}, #{default_time}, #{basic_fee}, #{rate_adjustment}, #{hot_time},#{contact}, #{info}, #{caution}, #{court}, #{product}, #{facility_status}, #{facility_images})
    </insert>

    <!-- insert -->
    <insert id="insertUser" parameterType="com.green.smarty.vo.UserVO">
        INSERT INTO user_tbl (user_id, user_name, email, password, phone, address, birthday, join_date, login_date, user_status, level, qr_Code)
        VALUES (#{user_id}, #{user_name}, #{email}, #{password}, #{phone}, #{address}, #{birthday}, #{join_date}, #{login_date}, #{user_status}, #{level}, #{qrCode})
    </insert>
    
    <insert id="insertReservation" parameterType="com.green.smarty.vo.ReservationVO">
        insert into reservation(reservation_id, user_id, court_id, reservation_start, reservation_end)
        select #{reservation_id}, #{user_id}, c.court_id, #{reservation_start}, #{reservation_end} from court c
        join facility f on c.facility_id = f.facility_id where c.facility_id = #{facility_id} and c.court_id = #{court_id}
    </insert>

    <insert id="insertCourt" parameterType="com.green.smarty.vo.CourtVO">
        insert into court(court_id, court_name, facility_id, court_status) values(#{court_id}, #{court_name}, #{facility_id}, #{court_status})
    </insert>

    <!-- select -->
    <select id="getFacility" parameterType="String" resultType="com.green.smarty.vo.FacilityVO">
        select * from facility where facility_id = #{facility_id}
        <!-- select * from facility f inner join court c on c.facility_id = f.facility_id and c.court_id = #{court_id} where f.facility_id= #{facility_id}; -->
    </select>

    <!-- <select id="getReservation" parameterType="String" resultType="com.green.smarty.vo.ReservationVO">
        select * from reservation join court where facility_id = #{facility_id}
    </select> -->
    <select id="getReservation" parameterType="map" resultType="com.green.smarty.vo.ReservationVO">
        select * from reservation join court c on c.facility_id = #{facility_id} and c.court_id = #{court_id};
    </select>
    <select id="getReservationAll" resultType="com.green.smarty.vo.ReservationVO">
        select * from reservation 
    </select>
</mapper>